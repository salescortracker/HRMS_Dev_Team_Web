<div class="card shadow-sm">
  <div class="container-fluid p-4 news-management">

    <!-- ADD / EDIT FORM -->
    <div class="card shadow-sm p-3 mb-3">
      <h5>Add / Configure Event</h5>

      <form>
        <div class="row g-3">

          <div class="col-md-4">
            <label class="form-label">Event Name</label>
            <input type="text"
                   class="form-control"
                   [(ngModel)]="eventForm.eventName"
                   name="eventName"
                   required>
          </div>

          <div class="col-md-4">
            <label class="form-label">Event Type</label>
            <select class="form-select"
                    [(ngModel)]="eventForm.eventTypeId"
                    name="eventTypeId">
              <option value="">Select type</option>
              <option *ngFor="let t of eventTypes"
                      [value]="t.eventTypeId">
                {{ t.eventTypeName }}
              </option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label">Date</label>
            <input type="date"
                   class="form-control"
                   [(ngModel)]="eventForm.eventDate"
                   name="eventDate">
          </div>

          <div class="col-md-12">
            <label class="form-label">Description</label>
            <textarea class="form-control"
                      [(ngModel)]="eventForm.description"
                      name="description"></textarea>
          </div>

          <div class="col-md-12 text-end">
            <button type="button"
                    class="btn btn-primary"
                    (click)="saveEvent()">
              {{ isEdit ? 'Update Event' : 'Save Event' }}
            </button>
          </div>

        </div>
      </form>
    </div>

    <!-- LIST & FILTER -->
    <div class="card shadow-sm p-3">
      <h5>Events List</h5>

      <div class="row g-3 mb-3">
        <div class="col-md-3">
          <input type="text"
                 class="form-control"
                 placeholder="Search event"
                 [(ngModel)]="searchText"
                 name="searchText">
        </div>

        <div class="col-md-2">
          <input type="date"
                 class="form-control"
                 [(ngModel)]="fromDate"
                 name="fromDate">
        </div>

        <div class="col-md-2">
          <input type="date"
                 class="form-control"
                 [(ngModel)]="toDate"
                 name="toDate">
        </div>

        <div class="col-md-2">
          <button type="button"
                  class="btn btn-secondary w-100"
                  (click)="applyFilter()">
            Filter
          </button>
        </div>

        <div class="col-md-3">
          <select class="form-select"
                  [(ngModel)]="pageSize"
                  (change)="changePageSize(pageSize)"
                  name="pageSize">
            <option *ngFor="let size of pageSizes"
                    [value]="size">
              Show {{ size }} rows
            </option>
          </select>
        </div>
      </div>

      <table class="table table-bordered table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>S.No</th>
            <th>Event Name</th>
            <th>Type</th>
            <th>Date</th>
            <th>Description</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let e of filteredEvents; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ e.eventName }}</td>
            <td>{{ getEventTypeName(e.eventTypeId) }}</td>
            <td>{{ e.eventDate | date:'dd-MMM-yyyy' }}</td>
            <td>{{ e.description }}</td>
            <td class="text-center">
              <button class="btn btn-sm btn-outline-primary me-2"
                      (click)="editEvent(e)">
                <i class="fa-solid fa-pen-to-square"></i>
              </button>

              <button class="btn btn-sm btn-outline-danger"
                      (click)="deleteEvent(e.eventId)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>

      </table>

      <!-- PAGINATION -->
      <div class="d-flex justify-content-between align-items-center mt-3">
        <div>
          <span class="text-muted">Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, totalEvents) }} of {{ totalEvents }} events</span>
        </div>
        <nav aria-label="Page navigation">
          <ul class="pagination mb-0">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button type="button" 
                      class="page-link" 
                      (click)="goPrevious()"
                      [disabled]="currentPage === 1">
                Previous
              </button>
            </li>
            <li class="page-item" *ngFor="let page of getPageNumbers()" 
                [class.active]="page === currentPage">
              <button type="button"
                      class="page-link"
                      (click)="goToPage(page)">
                {{ page }}
              </button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === getTotalPages()">
              <button type="button"
                      class="page-link"
                      (click)="goNext()"
                      [disabled]="currentPage === getTotalPages()">
                Next
              </button>
            </li>
          </ul>
        </nav>
      </div>

    </div>

  </div>
</div>

<app-header></app-header>
<app-sidebar></app-sidebar>

<div class="dashboard-header">
  <h2 class="dashboard-title">Company Policies</h2>
</div>

<div class="p-4">

  <!-- FILTER BAR -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body row g-3 align-items-end">
      <div class="col-md-4">
        <label class="form-label">Category</label>
       <select
          class="form-select"
          [(ngModel)]="selectedCategory"
        >
          <option value="">All Categories</option>
          <option *ngFor="let c of categories" [value]="c.categoryName">
            {{ c.categoryName }}
          </option>
        </select>

      </div>

      <div class="col-md-3">
        <label class="form-label">From Date</label>
        <input type="date" class="form-control" [(ngModel)]="fromDate">
      </div>

      <div class="col-md-3">
        <label class="form-label">To Date</label>
        <input type="date" class="form-control" [(ngModel)]="toDate">
      </div>

      <div class="col-md-2">
        <button class="btn btn-danger w-100" (click)="applyFilter()">Filter</button>
      </div>
    </div>
  </div>

  <!-- POLICY CARDS -->
  <div class="row g-4">
    <div class="col-md-4"
         *ngFor="let p of filteredPolicies()">

      <div class="card policy-card h-100 shadow-sm">
        <div class="card-body">

          <!-- TITLE + DATE -->
          <div class="d-flex justify-content-between align-items-start mb-2">
            <h5 class="fw-semibold mb-0">
              {{ p.title }}
            </h5>
            <small class="text-muted">
              {{ p.effectiveDate | date:'dd-MMM-yyyy' }}
            </small>
          </div>

          <!-- CATEGORY BADGE -->
          <span class="badge bg-info mb-2">
            {{ p.categoryName }}
          </span>

          <!-- DESCRIPTION -->
          <p class="text-muted mt-2">
            {{ p.description }}
          </p>
        </div>

        <!-- FOOTER -->
        <div class="card-footer bg-transparent border-top-0">
          <a *ngIf="p.filePath"
             class="text-primary fw-semibold"
             style="cursor:pointer"
             (click)="viewDocument(p.filePath)">
            View Attachment
          </a>

          <span *ngIf="!p.filePath" class="text-muted">
            No Attachment
          </span>
        </div>
      </div>

    </div>

    <!-- NO DATA -->
    <div *ngIf="filteredPolicies().length === 0"
         class="text-center text-muted py-5">
      No policies found
    </div>
  </div>

</div>
<app-footer></app-footer>

<!-- Approval Table -->
<div class="dashboard-tables full-row mt-2">
  <div class="table-card">
    <h3>Timesheet Approvals</h3>

    <div class="table-responsive">
      <table class="table table-bordered align-middle">
        <thead class="table-dark">
          <tr>
            <th>
              <input type="checkbox" [(ngModel)]="selectAll" (change)="toggleSelectAll()" />
            </th>
            <th>Employee Name</th>
            <th>Employee ID</th>
            <th>Project / Client</th>
            <th>Task / Activity</th>
            <th>Date</th>
            <th>Total Hours</th>
            <th>OT Hours</th>
            <th>Approver Comments</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let ts of timesheetList">
            <td>
              <input
                *ngIf="ts.status === 'Pending'"
                type="checkbox"
                [(ngModel)]="ts.selected"
                (change)="checkSelectAll()"
              />
            </td>

            <td>{{ ts.employeeName }}</td>
            <td>{{ ts.employeeId }}</td>
            <td>{{ ts.project }}</td>
            <td>{{ ts.task }}</td>
            <td>{{ ts.date }}</td>
            <td>{{ ts.totalHours }}</td>
            <td>{{ ts.otHours }}</td>

            <td>
              <textarea class="form-control" rows="1"
                        [(ngModel)]="ts.comments"
                        placeholder="Enter comments"></textarea>
            </td>

            <!-- âœ… Status badge -->
            <td>
              <span
                class="badge"
                [ngClass]="{
                  'bg-warning text-dark': ts.status === 'Pending',
                  'bg-success': ts.status === 'Approved',
                  'bg-danger': ts.status === 'Rejected'
                }"
              >
                {{ ts.status }}
              </span>
            </td>

            <!-- ðŸ‘ View -->
            <td class="text-center">
              <a
                href="#"
                (click)="openViewModal(ts)"
                data-bs-toggle="modal"
                data-bs-target="#viewTimesheetModal"
              >
                <i class="fa-solid fa-eye text-primary"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <button class="btn btn-success me-2" (click)="approveSelected()">
        Approve Selected
      </button>
      <button class="btn btn-danger" (click)="rejectSelected()">
        Reject Selected
      </button>
    </div>
  </div>
</div>

<!-- âœ… View Modal -->
<div class="modal fade" id="viewTimesheetModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Timesheet Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <p><b>Employee:</b> {{ selectedTimesheet?.employeeName }}</p>
        <p><b>Project:</b> {{ selectedTimesheet?.project }}</p>
        <p><b>Task:</b> {{ selectedTimesheet?.task }}</p>
        <p><b>Date:</b> {{ selectedTimesheet?.date }}</p>
        <p><b>Total Hours:</b> {{ selectedTimesheet?.totalHours }}</p>
        <p><b>OT Hours:</b> {{ selectedTimesheet?.otHours }}</p>
        <p>
          <b>Status:</b>
          <span class="badge bg-secondary">{{ selectedTimesheet?.status }}</span>
        </p>
      </div>

      <div class="modal-footer" *ngIf="selectedTimesheet?.status === 'Pending'">
        <button
          class="btn btn-success"
          (click)="approveFromPopup()"
          data-bs-dismiss="modal"
        >
          Approve
        </button>
        <button
          class="btn btn-danger"
          (click)="rejectFromPopup()"
          data-bs-dismiss="modal"
        >
          Reject
        </button>
      </div>

    </div>
  </div>
</div>
